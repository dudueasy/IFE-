<!DOCTYPE html>

<head>
    <title>IFE JavaScript Task 03</title>
    <meta charset="UTF-8">
</head>

<body>

    <ul id="source">
        <li>北京空气质量：<b>90</b></li>
        <li>上海空气质量：<b>70</b></li>
        <li>天津空气质量：<b>80</b></li>
        <li>广州空气质量：<b>50</b></li>
        <li>深圳空气质量：<b>40</b></li>
        <li>福州空气质量：<b>32</b></li>
        <li>成都空气质量：<b>90</b></li>
    </ul>

    <ul id="resort">

    </ul>
    <button id="sort-btn">排序</button>

    <!--  /////////      script goes here            ////////     -->
    <script>
        window.onload = function() {
            var button = document.getElementById("sort-btn");
            button.onclick = btnHandler;
        }


        //get a Array of cities and their aqi;
        function getData() {
            var data = [];
            var source = document.getElementById("source");
            var listArray = source.getElementsByTagName("li");
            for (i = 0; i < listArray.length; i++) {
                var str = listArray[i].innerHTML;
                var city = str.substring(0, 2);
                var aqi = str.substring(str.length - 6, str.length - 4);
                var cityArray = [city, aqi];
                data.push(cityArray);
            }
            return data;
        }
        //begin sorting
        function sortAqiData(data) {
            data.sort(function(a, b) {
                return a[1] - b[1];
            })
            return data;
        }



        //display sorted data;
        function render(data) {
            var ul = document.getElementById("resort");
            ul.innerHTML = ""
            var numArray = ["一", "二", "三", "四", "五", "六", "七"];
            for (i = 0; i < data.length; i++) {
                var city = data[i][0];
                var aqi = data[i][1];
                var li = document.createElement("li");
                li.innerHTML = "第" + numArray[i] + "名：" + city + "空气质量：<b>" + aqi + "</b>";
                ul.appendChild(li);
            }
        }


        function btnHandler() {
            var aqiData = getData();
            sortAqiData(aqiData);
            render(aqiData);

        }
    </script>
</body>


</html>
